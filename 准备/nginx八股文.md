1. 基础工作原理

   nginx采用一个master进程，多个woker进程的模式。

   - master进程主要负责收集、分发请求。每当一个请求过来时，master就拉起一个worker进程负责处理这个请求。
   - 同时master进程也负责监控woker的状态，保证高可靠性
   - woker进程一般设置为跟cpu核心数一致。nginx的woker进程在同一时间可以处理的请求数只受内存限制，可以处理多个请求。
   - Nginx 的异步非阻塞工作方式正把当中的等待时间利用起来了。在需要等待的时候，这些进程就空闲出来待命了，因此表现为少数几个进程就解决了大量的并发问题。

   

2. 为什么nginx不使用多线程

   采用独立的进程，彼此之间不会影响，提高可靠性

   进程不共享资源，不需要加锁，减少锁的开销，提高可用性

   采用epoll，以及异步IO，I/O效率已经很高了，服务器作为IO密集型的应用 ，cpu基本上始终保持运行状态，加入多线程意义并不大

   

   进程：资源调度的最小单位 一个进程有多个线程

   线程：cpu执行的最小单位，一个cpu一次只能执行一个线程，当一个线程陷入沉睡的时候或者到达执行的最大事件，会切换到另一个线程去工作，有几个cpu 就能同时执行几个线程

   协程: 在同一个线程下来回切换，完全是用户空间下的并发，因为始终在同一个线程下 不需要cpu进行切换 效率更高

   

3. nginx负载均衡算法以及策略

   轮询 按顺序轮流分配

   权重 权重越高 几率越大

   IP绑定 同一ip永远打到一个上 解决session问题



4. nginx虚拟主机 通过不同的域名 端口 ip 来进行资源的映射管理

   

5. nginx限流

   漏桶算法 将所有的请求放入桶中(等待队列) 然后按照固定的速率去处理请求

   令牌桶    按照速度向容器中发放令牌 然后请求申请令牌 只有有令牌的请求才能进行处理

   三种限制 正常流量限制(直接限制处理速度 如最多1s处理5个) 突发流量限制(对额外的请求限速 如对于某个用户的前五个请求 正常处理 对于后续的请求 就是随机处理) 以及并发数限制(限制单个ip的最大连接数)



6. 上游服务器的健康检查

   利用 nginx 自带模块 ngx_http_proxy_module 和 ngx_http_upstream_module 对后端节点做健康检查



7. C10K问题是指无法同时处理大量客户端(10,000)的网络套接字。